<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TagOrder 관리자 페이지</title>
    <link href="./allcss.css" rel="stylesheet">
</head>
<body>
<div class="grid-container">
    <form class="menu_container" action="/TestStore/TestStore_admin/Order_related_page/test" method="GET">
        <button type="submit">
            <h2>정산 관리</h2>
        </button>
    </form>
    <form class="menu_container" action="/TestStore/TestStore_admin/Modifying_menu_page/TestStore_menu_modify" method="GET">
        <button type="submit">
            <h2>메뉴 관리</h2>
        </button>
    </form>
    <form class="menu_container" onsubmit="saveStoreLocation(); return false;">
        <button type="submit">
            <h2>가게 GPS 저장</h2>
        </button>
    </form>
</div>

<!-- ✅ 위치 저장 스크립트 추가 -->
<script>
    function saveStoreLocation() {
        if (!navigator.geolocation) {
            alert("브라우저가 위치 정보를 지원하지 않습니다.");
            return;
        }

        navigator.geolocation.getCurrentPosition(
            (position) => {
                const lat = position.coords.latitude;
                const lng = position.coords.longitude;

                fetch('/saveStoreLocation', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        store: 'firstStore',  // 필요 시 수정
                        lat: lat,
                        lng: lng
                    })
                })
                    .then(res => res.json())
                    .then(data => {
                        if (data.success) {
                            alert(`위치 저장 완료\n위도: ${lat}, 경도: ${lng}`);
                        } else {
                            alert("저장 실패: " + data.message);
                        }
                    })
                    .catch(err => {
                        console.error("서버 오류:", err);
                        alert("서버 통신 오류 발생");
                    });
            },
            (err) => {
                alert("위치 정보를 가져올 수 없습니다: " + err.message);
            }
        );
    }
</script>
</body>
</html>
